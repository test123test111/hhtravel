@model HHTravel.CRM.Booking_Online.Site.Models.ProductListModel
@{
    ViewBag.Title = "实现顶级旅游者的梦想‧鸿鹄逸游 HHtravel";
    Layout = "~/Views/Shared/_Layout2.cshtml";
}
@section JS{
    <script type="text/javascript">
        $(function () {
            var h = $('.l_left').height();
            $('.l_link').css('padding-top', (h - 120) / 2);
        });
    </script>
}
@if (Model.ProductList.Count() > 0)
{
    @Html.Partial("_ProductListBar", Model)
    <div class="list_warp">
        @foreach (Product p in Model.ProductList)
        {
            string daysText = (p.TravelType == TravelType.单品游) ?
            string.Format("{0}天/{1}晚", p.Days, p.MinLodgingDays ?? p.Days - 1) :
            string.Format("{0}天", p.Days);
            <!--list_item begin-->
            <div class="list_item">
                @if (p.HasDiscount)
                { 
                    <h5 class="l_tit tag_sale">
                        <a href="@Url.Action("Details", new { productNo = p.ProductNo })">@p.ProductName</a></h5>
                }
                else
                {
                    <h5 class="l_tit">
                        <a href="@Url.Action("Details", new { productNo = p.ProductNo })">@p.ProductName</a></h5>
                }
                <p class="l_desc">
                    @Html.TruncateProductDescription(p.Feature, 100, p.ProductNo)</p>
                <div class="l_main">
                    <div class="l_left">
                        @Html.Image(p.MainImage, Url.Content("~/images/nopic.gif"), p.ProductName)
                        <ul class="l_theme">
                            <!--liuyan:单品游-城市，团队/自由行-旅行主题，另外还需要显示旅游形态的图标-->
                            @if (p.TravelType == TravelType.单品游)
                            {
                                
                                <li><span class="name">城市：</span><span class="value">@p.DestinationCity</span></li>
                            }
                            else
                            {
                                <li><span class="name">旅行主题：</span><span class="value">@string.Join("、", p.InterestList.Select(i => i.Name ?? ""))</span></li>
                            }
                            <li>
                                @if (p.TravelType == TravelType.单品游)
                                {
                                    <span class="name">入住日期：</span>}
                                else
                                { 
                                    <span class="name">出发日期：</span>}<span class="value">@string.Join("/", p.DepartureDateList.Select(d => d.ToString("yyyy.MM.dd")).Take(3))
                                        @if (p.DepartureDateList.Count > 3)
                                        {
                                            <a class="data_more" style="color: #5a5a5a;" href="@Url.Action("Details", new { productNo = p.ProductNo, tab = 3 })">
                                                ...</a>
                                        }</span></li>
                            <li><span class="name">天 数：</span><span class="value">@daysText</span></li>
                            <li><span class="name">价 格：</span><span class="value"><em>RMB @p.MinPrice</em>元起(含税)</span></li>
                        </ul>
                        <p class="type_label">@p.TravelType.ToString()</p>
                    </div>
                    <ul class="l_link">
                        <li>．<a href="@Url.Action("Details", new { productNo = p.ProductNo, tab = 0 })">行程亮点</a></li>
                        <li>．<a href="@Url.Action("Details", new { productNo = p.ProductNo, tab = 1 })">详细行程</a></li>
                        <li>．<a href="@Url.Action("Details", new { productNo = p.ProductNo, tab = 2 })">精选饭店</a></li>
                        <li>．<a href="@Url.Action("Details", new { productNo = p.ProductNo, tab = 3 })">日期订购</a></li>
                        @if (p.TravelType != TravelType.单品游)
                        { 
                            <li>．<a href="@Url.Action("Details", new { productNo = p.ProductNo, tab = 4 })">量身订做</a></li>
                        }
                    </ul>
                </div>
            </div>
            <!--list_item end-->
        }
        <div class="sort_page_warp" style="margin-top: 15px;">
            <p class="page">
                @Html.Partial("_Pager", Model.PagerModel)
            </p>
        </div>
    </div>
}
else
{
    if (Model.TravelType.HasValue)
    {
    @Html.Partial("_ProductListBar", Model) 
    }
    <!--no data begin-->
    <div class="no_data_warp">
        很抱歉，暂时没有找到符合您要求的产品。
        <p>
            <b>鸿鹄建议您：</b><br />
            1.更换其他搜索条件试试看;<br />
            2.联系鸿鹄客服400 690 2323</p>
    </div>
}
