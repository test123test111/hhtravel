@model HHTravel.Site.Models.OrderModel
@{
    ViewBag.Title = "高端游需求单";
    Layout = "~/Views/Shared/_LayoutPopup.cshtml";
}
<table border="0" cellpadding="0" cellspacing="0" width="700" style="border-collapse: collapse;
    margin-left: 10px;">
    <tr>
        <td>
            <a href="@Url.AbsoluteIndex()">
                <img alt="鸿鹄逸游" src="@Url.AbsoluteContent("~/images/email_h_bg.jpg")" width="700" height="100" style="border:none;" /></a>
        </td>
    </tr>
    <tr>
        <td style="padding: 20px 0 5px 0; font-size: 16px; line-height: 22px; color: #24747b;">
            <b>高端游需求单</b>
        </td>
    </tr>
    <tr>
        <td style="padding-top: 15px; font-size: 13px; line-height: 22px; color: #5a5a5a;">
            <b>订单编号：@Html.DisplayFor(om => om.OrderNo)</b><br />
            感谢您对鸿鹄逸游的支持！您的预订需求已转交专属服务人员处理中，敬请耐心等候。如有任何疑问，欢迎与我们联系。
        </td>
    </tr>
    <tr>
        <td style="padding: 20px 0 10px; border-bottom: 1px solid #ccc; font-size: 13px;
            line-height: 22px; color: #5a5a5a;">
            鸿鹄．上海<br />
            .服务电话 400 690 2323<br />
            .服务时间 周一至周五 9：00～18：00
        </td>
    </tr>
    <tr>
        <td style="padding: 20px 0 5px 0; font-size: 13px; line-height: 22px; color: #5a5a5a;">
            <b>基本数据</b>
            <table border="0" cellpadding="0" cellspacing="0" width="700" style="border-collapse: collapse;">
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        中文姓名
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.BasicInfoModel.FirstName)
                        @Html.DisplayFor(om => om.BasicInfoModel.LastName)
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        英文姓名
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.BasicInfoModel.FirstNameEn)
                        @Html.DisplayFor(om => om.BasicInfoModel.LastNameEn)
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        联络电话
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.BasicInfoModel.PhoneNumber)
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        E-mail
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.BasicInfoModel.Email)
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        参加人数
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">
                        成人：
                        @Html.DisplayFor(om => om.PreOrderModel.AdultCount)，孩童：
                        @Html.DisplayFor(om => om.PreOrderModel.ChildCount)
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        随行游客
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">
                        @for (int i = 0; i < Model.OtherCustomerModelList.Count; i++)
                        {
                            var cm = Model.OtherCustomerModelList[i];
                            <p class="traveler_msg">
                                <b>第@(i + 1)位旅客</b></p>
                            <p class="traveler_msg">
                                <span class="tbl_attr">中文姓名：</span>@cm.FirstName@cm.LastName</p>
                            <p class="traveler_msg">
                                <span class="tbl_attr">英文姓名：</span>@cm.FirstNameEn@cm.LastNameEn
                            </p>

                        }
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        联络方式偏好
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.BasicInfoModel.ContactFavorite)
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        方便接听电话时间
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.BasicInfoModel.ConvinientTime)
                    </td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td style="padding: 20px 0 5px 0; font-size: 13px; line-height: 22px; color: #5a5a5a;">
            <b>行程需求</b>
            <table border="0" cellpadding="0" cellspacing="0" width="700" style="border-collapse: collapse;">
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        商品名称
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;">
                        <a href="@Url.Product(Model.PreOrderModel.ProductNo)" style="color: #24747b; text-decoration: none;">@Model.PreOrderModel.ProductName</a>
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        天数
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.PreOrderModel.Days) 天
                    </td>
                </tr>
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        预定出发日期
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #5a5a5a;">@Html.DisplayFor(om => om.PreOrderModel.DepartureDate)
                    </td>
                </tr>
                @if (Model.StayInfoModel.StayReturnDate.HasValue)
                {
                    <tr>
                        <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                            font-size: 13px; line-height: 22px; color: #5a5a5a;">
                            预定回程日期
                        </td>
                        <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a;">
                            @Html.DisplayFor(om => om.StayInfoModel.StayReturnDate)
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                            font-size: 13px; line-height: 22px; color: #5a5a5a;">
                            是否需安排续住
                        </td>
                        <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a;">
                            @Html.DisplayFor(om => om.StayInfoModel.IsHotelStay)
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                            font-size: 13px; line-height: 22px; color: #5a5a5a;">
                            仅参加当地行程，机票自理
                        </td>
                        <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a;">
                            @Html.DisplayFor(om => om.StayInfoModel.AirTicketOneself)
                        </td>
                    </tr>
                    <tr>
                        <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                            font-size: 13px; line-height: 22px; color: #5a5a5a;">
                            其他
                        </td>
                        <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a;">
                            @Html.DisplayFor(om => om.StayInfoModel.StayNote)
                        </td>
                    </tr>
                }
                <tr>
                    <td style="width: 180px; padding: 6px 0 6px 20px; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a;">
                        订购总价
                    </td>
                    <td style="padding-left: 20px; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                        color: #eb6100;">
                        RMB @Html.DisplayFor(om => om.Amount)<span style="color: #999; padding-left: 10px;">@if (!Model.StayInfoModel.StayReturnDate.HasValue)
                                                                                                            {<text>(不包含延长行程价格)</text>
                                                                                                            }
                                                                                                            else
                                                                                                            {
                            <text></text>
                                                                                                            }</span>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td style="padding: 20px 0 5px 0; font-size: 13px; line-height: 22px; color: #5a5a5a;">
            <b>酒店资讯</b>
            <table border="0" cellpadding="0" cellspacing="0" width="700" style="border-collapse: collapse;">
                <tr>
                    <td style="padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7; font-size: 13px;
                        line-height: 22px; color: #5a5a5a; text-align: center;">
                        酒店
                    </td>
                    <td style="width: 120px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        房型
                    </td>
                    <td style="width: 120px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        早晚餐说明
                    </td>
                    <td style="width: 90px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        入住/晚
                    </td>
                    <td style="width: 80px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        数量
                    </td>
                </tr>
                @for (int i = 0; i < Model.HotelSegmentModelList.Count; i++)
                {
                    var seg = Model.HotelSegmentModelList[i];
                    for (int j = 0; j < seg.SelectedRoomClassPostModelList.Count; j++)
                    {
                    <tr>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: left;">
                            @seg.DestinationCity @seg.SelectedHotelModel.HotelName
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @seg.SelectedRoomClassPostModelList[j].RoomClassName
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @seg.SelectedRoomClassPostModelList[j].BreakfastDinnerTip
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">@seg.Nights
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @(seg.SelectedRoomClassPostModelList[j].Count)间
                        </td>
                    </tr>
                    }
                }
            </table>
        </td>
    </tr>
    <tr>
        <td style="padding: 20px 0 5px 0; font-size: 13px; line-height: 22px; color: #5a5a5a;">
            <b>航班资讯</b><span style="padding-left:10px; color:Red;">（航班信息仅供参考，具体航班以届时客服与您确认为准。）</span>
            <table border="0" cellpadding="0" cellspacing="0" width="700" style="border-collapse: collapse;">
                <tr>
                    <td style="width: 70px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        行程
                    </td>
                    <td style="padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7; font-size: 13px;
                        line-height: 22px; color: #5a5a5a; text-align: center;">
                        航空公司
                    </td>
                    <td style="width: 70px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        航班
                    </td>
                    <td style="width: 70px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        舱等
                    </td>
                    <td style="width: 85px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        出发地
                    </td>
                    <td style="width: 85px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        到达地
                    </td>
                    <td style="width: 70px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        出发时间
                    </td>
                    <td style="width: 70px; padding: 6px 0; border: 1px solid #cccccc; background: #e4e5e7;
                        font-size: 13px; line-height: 22px; color: #5a5a5a; text-align: center;">
                        到达时间
                    </td>
                </tr>
                @foreach (var f in Model.SelectedTicketModel.FlightModelList)
                {
                    <tr>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.SectionName
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.Airline
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.FlightNo
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @Model.SelectedTicketModel.FlightClassName
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.DepartureAirport
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.ArrivalAirport
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.DepartureTime
                        </td>
                        <td style="padding: 6px 0; border: 1px solid #cccccc; font-size: 13px; line-height: 22px;
                            color: #5a5a5a; text-align: center;">
                            @f.ArrivalTime
                        </td>
                    </tr>
                }
            </table>
        </td>
    </tr>
    @if (!Model.UsedByEmail)
    {
        <tr>
            <td>
                <p class="tbl_send_warp">
                    @*http://blogs.x2line.com/al/articles/350.aspx*@ <a id="lnkClose" class="close_link_green" href="javascript:window.opener='x';window.close();">
                        关闭本窗口</a></p>
            </td>
        </tr>
    }
    <tr>
        <td style="padding-top: 20px;">
            <img alt="" src="@Url.AbsoluteContent("~/images/email_f_bg.jpg")" width="700" height="53" />
        </td>
    </tr>
</table>